# Контроль выполнения работ с использованием QR-кодов

Это проект на Django с использованием Django Rest Framework (DRF), который позволяет отслеживать выполнение работ с помощью мобильного приложения и QR-кодов. Система включает админ-панель для контроля за выполнением работ, а также интерфейсы для рабочих и администраторов. Работы могут быть отслежены с помощью сканирования QR-кодов, что позволяет проверять их выполнение и качество без необходимости очных встреч.

## Описание

В рамках проекта создается несколько приложений на Django:

- **admin_panel**: Админ-панель для контроля всех объектов и работ.
- **auth_app**: Авторизация и аутентификация пользователей.
- **main_admin**: Панель для администраторов для просмотра и управления работами.
- **main_app**: Панель для рабочих для начала и завершения работ, а также оценки качества выполненных задач. - Созданно

### Основные функции

- Генерация и сканирование QR-кодов для отслеживания начала и окончания работы.
- Оценка качества работы проверяющим, который может приложить фотографии и оставить комментарии.
- Мобильное приложение для рабочих и контролирующих с возможностью взаимодействовать через QR-коды.
- Админ-панель для управления объектами и просмотра статистики.

## Готовые функции

### Swagger
По пути `/swagger/` можно открыть Swagger UI для документации и тестирования API.

### Auth (`/api/v1/auth`)
- **POST /api/v1/auth/login/**  
  Авторизация пользователя. Возвращает `access_token` и `refresh_token`.
  
- **POST /api/v1/auth/register/**  
  Регистрирует нового пользователя. Возвращает сообщение с статусом.

- **GET /api/v1/auth/ping/**  
  Проверяет авторизацию пользователя и работоспособность сервера. Возвращает статус 401, 200 или 500.

- **POST /api/v1/auth/refresh/**  
  Создает новый `access_token` на основе `refresh_token`.

- **POST /api/v1/auth/logout/**  
  Добавляет в чёрный лист refresh_token, каким образом позволяет разлогинить юзера (access token на фронте чистится)

- **GET /api/v1/auth/status/**  
  Возвращает два варианта запроса: {"status": "staff"}, {"status": "user"}, {"status": "unauthentificated"}


### Main_app (`/api/v1/work`)

- **POST /api/v1/auth/login/**  




## Установка и запуск

### Требования

- Python 3.9+
- Django 3.x+
- Django Rest Framework

### Шаги для установки

1. Клонировать репозиторий:

   ```bash
   git clone <url_репозитория>
   cd <директория_проекта>
   ```
2. Создать и активировать виртуальное окружение:
    ```bash
    python -m venv venv
    source venv/bin/activate  # для Linux/macOS
    venv\Scripts\activate  # для Windows
    ```
3. Устаноивить зависимости:
    ```bash
    pip install -r requirements.txt
    ```
4. Запустить миграции:
    ```bash
    python manage.py migrate
    ```
5. Запустить бэк на своем сервере:
    ```
    python manage.py runserver
    ```
# Структура проекта

## Структура файловой системы
```plaintext
QRSystem/
├── admin_panel/           # Приложение для админ-панели
├── auth_app/              # Приложение для авторизации и аутентификации
├── main_admin/            # Приложение для панели администратора
├── main_worker/           # Приложение для панели рабочего
├── QRSystem/             # Основная директория проекта
│   ├── settings.py        # Настройки проекта
│   ├── urls.py            # Маршруты проекта
│   └── wsgi.py            # WSGI-конфигурация
└── manage.py              # Скрипт для управления проектом
```
## Ветки Git
- master: Стабильная версия проекта для продакшн.
- dev: Разработка новых функций и изменений.

# Проект с использованием Docker Compose

Этот проект состоит из нескольких сервисов: бэкенда, фронтенда и Nginx. Docker Compose используется для управления всеми сервисами.

## Структура проекта

Проект включает следующие компоненты:

- **Backend**: Django приложение с API.
- **Frontend**: Приложение на React, которое клонируется с репозитория [https://github.com/The-Mixa/QRcodiky](https://github.com/The-Mixa/QRcodiky).
- **Nginx**: Сервер, который проксирует запросы между фронтендом и бэкендом.

## Процесс запуска

### 1. Запуск бэкенда, фронтенда и Nginx

Для того чтобы запустить все сервисы (бэкенд, фронтенд и Nginx), выполните следующую команду:

```bash
docker-compose up --build
```

- **Что происходит**:
  - Бэкенд и фронтенд запускаются как контейнеры.
  - Nginx настроен для проксирования запросов:
    - Запросы на порт `8000` обрабатываются бэкендом.
    - Запросы на порт `3000` обрабатываются фронтендом.
    - Все запросы на порт `8080` обрабатываются Nginx, который распределяет их между фронтендом и бэкендом в зависимости от пути.
  - Фронтенд автоматически клонируется с ветки `master` репозитория [https://github.com/The-Mixa/QRcodiky](https://github.com/The-Mixa/QRcodiky).

- **Доступность**:
  - Бэкенд доступен по адресу: `http://localhost:8000`
  - Фронтенд доступен по адресу: `http://localhost:3000`
  - Объединенный сайт через Nginx доступен по адресу: `http://localhost:8080`

### 2. Запуск только бэкенда и базы данных (development)

Если нужно запустить только бэкенд и базу данных (например, для разработки), выполните следующую команду:

```bash
docker-compose -f docker-compose.development.yml up --build
```

- **Что происходит**:
  - Запускаются только сервисы **базы данных** и **бэкенда**.
  - Бэкенд будет доступен по порту `8000`.

- **Доступность**:
  - Бэкенд доступен по адресу: `http://localhost:8000`

### 3. Запуск бэкенда, фронтенда (из `dev` ветки) и Nginx (beta)

Если нужно запустить бэкенд, фронтенд из ветки `dev` и Nginx, выполните команду:

```bash
docker-compose -f docker-compose.beta.yml up --build
```

- **Что происходит**:
  - Запускаются сервисы **базы данных**, **бэкенда**, **фронтенда** (клон из ветки `dev` репозитория) и **Nginx**.
  - Фронтенд будет клонирован с ветки `dev` репозитория [https://github.com/The-Mixa/QRcodiky](https://github.com/The-Mixa/QRcodiky).

- **Доступность**:
  - Бэкенд доступен по адресу: `http://localhost:8000`
  - Фронтенд доступен по адресу: `http://localhost:3000`
  - Объединенный сайт через Nginx доступен по адресу: `http://localhost:8080`

## Дополнительные настройки

### Использование Nginx для проксирования запросов

Nginx в этом проекте настроен так, чтобы перенаправлять запросы в зависимости от пути:

- Запросы на `http://localhost:8080/api/` будут перенаправлены на бэкенд, который работает на порту `8000`.
- Все остальные запросы будут направлены на фронтенд, работающий на порту `3000`.

## Перезапуск контейнеров

Если нужно перезапустить контейнеры, можно выполнить команду:

```bash
docker-compose down
docker-compose up --build
```

Это остановит и удалит контейнеры, а затем пересоберет их с актуальными изменениями.

## Зависимости

Для работы проекта необходимы следующие зависимости:

- **Docker** и **Docker Compose** для запуска и управления контейнерами.
- **Git** для клонирования репозиториев.

## Лицензия

Этот проект распространяется под лицензией GNU. См. [LICENSE](LICENSE) для подробностей.

